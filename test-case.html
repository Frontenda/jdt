<script src="http://code.jquery.com/jquery-latest.min.js"></script>
<script src="jdt.js"></script>

<style>

	div.library { border : 2px solid black }
	div.library .statistics { border : 1px solid red }
	table.books { border : 1px solid black; width : 100%; }
	table.books .book .name span { font-weight : bold; color : red; }
	table.books .book .authors em { font-style : italic; color : green; }

	.error-message { border : 2px solid red; color : red; }

</style>

<script>
JDT.helper.DEBUG = true;
var json_data = { 
	'library' : {
		'statistics' : { 'books-count':10, 'currently-reading':'madness.txt'},
		'books' : [
			{'name' : 'Amber 1', 'authors' : ['Zheliazny', 'Plasmazny', 'Zemlianyj'], 'summary':'The Amber story - book 1', 'genre' : 'science-fiction'},
			{'name' : 'Amber 2', 'authors' : ['Zheliazny'], 'summary':'The Amber story - book 2', 'genre' : 'science-fiction'},
			{'name' : 'Amber 3', 'authors' : ['Zheliazny'], 'summary':'The Amber story - book 3', 'genre' : 'science-fiction'},
			{'name' : 'Amber 4', 'authors' : ['Zheliazny'], 'summary':'The Amber story - book 4', 'genre' : 'science-fiction'},
			{'name' : 'Amber 5', 'authors' : ['Zheliazny'], 'summary':'The Amber story - book 5', 'genre' : 'science-fiction'}
		],
		'shelfs' : [],
		'a-nema' : 'takogo'
	},
}
$(function(){ JDT.process(json_data); });
</script>

<div class="advanced_test library">
	
	<div class="statistics">
	 I have <span class="values">0</span> books in my collection and i am currently reading : <span class="currently-reading">a book</span>
	</div>

	<table class="books">
	<tr class="listing-header">
		<th>name</th>
		<th>author</th>
		<th>summary</th>
		<th>genre</th>
	</tr>
	<tr class="book item">
		<td class="name"><span class="value">My Book</span><span class="item">wtf</span></td>
		<td class="authors"><em class="item">Vasil Pupkin</em><span class="delimiter"> !!!NIHUJASOBI!!! </span></td>
		<td class="summary">It's a perfect book to fall asleep</td>
		<td class="genre">Sleper</td>
	</tr>
	<tr class="book item">
		<td class="name"><span class="value">His Book</span><span class="item">wtf</span></td>
		<td class="authors"><em class="item">Diadia Bubkin</em><span class="delimiter">|||</span></td>
		<td class="summary">It's the shittest book to fall asleep</td>
		<td class="genre">Fucker</td>
	</tr>
	</table>

</div>

<hr/>

<div class="array_data_test">
	<ul>
		<li class="item"><span class="key">do</span>:<span class="values"><span class="item">do</span><span class="delimiter">,</span><span class="item">did</span><span class="delimiter">,</span><span class="item">done</span></span></li>
		<li class="item"><span class="key">do</span>:<span class="values"><span class="item">do</span><span class="delimiter">,</span><span class="item">did</span><span class="delimiter">,</span><span class="item">done</span></span></li>
	</ul>
</div>

<hr/>

<script>
$(function(){ 
	try {
		JDT.process([1], jQuery('.error_test')); 
		// test
		should_equal('.error_test', false);
	} catch (e) {
		// error should apper here
	}
});
</script>
<div class="error_test">
	<p class="list"></p>
	<p class="list"></p>
</div>

<hr/>


<script>
$(function(){ 
	JDT.process('{"key":"value"}', jQuery('.string_json_test')); 
	// test
	should_equal('.string_json_test', jQuery('.string_json_test .key').text(),  'value' );	
});


function should_equal(error_class, value1, value2) {
	if ( value1 != value2 ) { jQuery(error_class).prepend('<div class="error-message">ERROR</div>'); };
}
</script>

<div class="string_json_test">	
	<p class="key">value-expectation</p>
</div>




<script>
var links_data = [
	{"link":{"href":"http://yahoo.com", 	"name":"yahoo"}},
	{"link":{"href":"http://altavista.com", "name":"altavista"}},
	{"link":{"href":"http://google.com", 	"name":"google"}},
	{"link":{"href":"http://bing.com", 		"name":"bing"}}
]	

$(function(){ 
	JDT.process(links_data, jQuery('.attributes_test')); 
	// test
	jQuery.each(links_data, function(index, link){
		should_equal('.attributes_test', link["link"]["href"], jQuery('.attributes_test .link:eq('+index+')').attr("href") );
		should_equal('.attributes_test', link["link"]["name"], jQuery('.attributes_test .link:eq('+index+') .name').text() );
})
	
});


function should_equal(error_class, expected, got) {
	if ( expected != got ) { 
		var error_message_container = jQuery(error_class).find('.error-message')
		if ( error_message_container.length == 0 ) { error_message_container = jQuery(error_class).prepend('<div class="error-message"><pre></pre></div>'); }
		
		var error_log = jQuery(error_class).find('.error-message pre').append('ERROR: expected "'+expected+'", got "'+got+'\n');
	};
}
</script>

<div class="attributes_test">	
	The search engines
	<ul>
	<li class="item"><a class="link" href="http://yahoo-template.com"><span class="name">yahoo-template</span></a></li>
	<li class="item"><a class="link" href="http://google-template.com"><span class="name">google-template</span></a></li>
	</ul>
</div>

<script>
$(function(){ 
	CONTAINER=jQuery(".input_value_test");
	data = {'color' : 'red', 'size' : 15 }
	JDT.process(data, CONTAINER);
	// test
	should_equal(CONTAINER, data['color'], jQuery(CONTAINER).find('.color input.value').val());
	should_equal(CONTAINER, data['size'], jQuery(CONTAINER).find('input.size').val());
})
	
</script>
<div class="input_value_test">	
	<span class="color"><input class="value" type="text" value="blue-template" /></span>
	<input class="size" type="text" value="10-template" />
</div>